<Window x:Class="NMEA2000Analyzer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:NMEA2000Analyzer"
        mc:Ignorable="d"
        Title="NMEA2000 Analyzer" 
        WindowState="Maximized"
        MinWidth="800"
        MinHeight="600">
    <DockPanel LastChildFill="True">
        <!-- Menu Bar -->
        <Menu DockPanel.Dock="Top">
            <Menu.ItemContainerStyle>
                <Style TargetType="MenuItem">
                    <Setter Property="Padding" Value="10,5" />
                    <!-- Adjust padding -->
                </Style>
            </Menu.ItemContainerStyle>
            <MenuItem Header="File">
                <MenuItem Header="Open" Click="OpenMenuItem_ClickAsync"/>
            </MenuItem>
            <MenuItem Header="Statistics">
                <MenuItem Header="PGNs" Click="PgnStatisticsMenuItem_Click" />
            </MenuItem>
            <MenuItem Header="Presets" x:Name="Presets">
            </MenuItem>
            <MenuItem Header="About" Click="AboutMenuItem_Click">
            </MenuItem>
        </Menu>

        <!-- Toolbar with Filters -->
        <StackPanel Orientation="Horizontal" DockPanel.Dock="Top" Margin="10">
            <TextBlock Text="Include PGNs:" VerticalAlignment="Center" Margin="5"/>
            <TextBox VerticalContentAlignment="Center" Width="200" x:Name="IncludeFilterTextBox" 
                 ToolTip="Comma-separated PGNs to include" 
                 TextChanged="FilterTextBoxes_TextChanged"/>

            <TextBlock Text="Exclude PGNs:" VerticalAlignment="Center" Margin="5"/>
            <TextBox VerticalContentAlignment="Center" Width="200" x:Name="ExcludeFilterTextBox" 
                 ToolTip="Comma-separated PGNs to exclude" 
                 TextChanged="FilterTextBoxes_TextChanged"/>
        </StackPanel>
        <StatusBar DockPanel.Dock="Bottom" x:Name="StatusBar" Height="30" VerticalAlignment="Center">
            <StatusBarItem>
                <TextBlock x:Name="TimestampRangeText" Text="No data loaded"/>
            </StatusBarItem>
        </StatusBar>
        <!-- DataGrid -->
        <DataGrid AutoGenerateColumns="False" Margin="5" 
          HorizontalAlignment="Stretch" 
          VerticalAlignment="Stretch" 
          x:Name="DataGrid" 
          GridLinesVisibility="All"
          HorizontalGridLinesBrush="#F0F0F0"
          VerticalGridLinesBrush="#F0F0F0"
          IsReadOnly="True"
          DockPanel.Dock="Top"
          CanUserResizeRows="False">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Seq" Binding="{Binding LogSequenceNumber}" />
                <DataGridTextColumn Header="Timestamp" Binding="{Binding Timestamp}" />
                <DataGridTextColumn Header="Src" Binding="{Binding Source}" />
                <DataGridTextColumn Header="Dst" Binding="{Binding Destination}" />
                <DataGridTextColumn Header="Prio" Binding="{Binding Priority}" />
                <DataGridTemplateColumn Header="PGN">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding PGN}" HorizontalAlignment="Center" VerticalAlignment="Center">
                                <TextBlock.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="Include"
                                          Click="IncludePgnMenuItem_Click"
                                          CommandParameter="{Binding PGN}" />
                                        <MenuItem Header="Open Reference"
                                          Click="ReferencePgnMenuItem_Click"
                                          CommandParameter="{Binding PGN}" />
                                    </ContextMenu>
                                </TextBlock.ContextMenu>
                            </TextBlock>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTextColumn Header="Type" Binding="{Binding Type}" />
                <DataGridTextColumn Header="Description" Binding="{Binding Description}" />

                <DataGridTextColumn Header="Raw" Binding="{Binding Data}" Width="*">
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="FontFamily" Value="Consolas"/>
                            <!-- Truncate text -->
                            <Setter Property="TextTrimming" Value="CharacterEllipsis" />
                            <Setter Property="TextWrapping" Value="NoWrap" />
                            <Setter Property="ToolTip" Value="{Binding Data}" />
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
            </DataGrid.Columns>
        </DataGrid>
    </DockPanel>
</Window>
